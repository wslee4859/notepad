
--기안서
--Y00CBC00E7ED9427EB7185EA0FBE35EDE
-- 기안서 지점용
--YEC587513360E4A069DE6F0966BB672D4
--거래처지원품의서 SAP
--Y96CFB35A64CC4889BA9B50FEB49E5DB9


[WF].[WF_FORMS] where FORM_NAME = '기안서'
[WF].[FORM_Y00CBC00E7ED9427EB7185EA0FBE35EDE]

-- 일반결재 리스트 (삭제되면 [WF].[PROCESS_INSTANCE_DELETE]로 이동)
-- 기안서
SELECT
F.ADD_FST_NUM AS [문서번호 부서],
F.ADD_SCD_NUM AS [문서번호 제 -],
F.ADD_TRD_NUM AS [문서번호 - 호],
M.NAME, 
replace(replace(M.SUBJECT,CHAR(13),''),CHAR(10),''),
CONVERT(varchar(10),M.CREATE_DATE,121) AS 기안일, 
M.CREATOR,
M.CREATOR_DEPT, 
M.DELETE_DATE
FROM
EWF.[WF].[PROCESS_INSTANCE] AS M
LEFT JOIN [WF].[FORM_Y00CBC00E7ED9427EB7185EA0FBE35EDE] AS F
ON F.PROCESS_ID = M.OID
where FORM_ID = 'Y00CBC00E7ED9427EB7185EA0FBE35EDE' 
AND M.CREATE_DATE < '2016-01-01'
AND state = '7'
order by 기안일 

-- 기안서(지점용)
SELECT
F.ADD_FST_NUM AS [문서번호 부서],
F.ADD_SCD_NUM AS [문서번호 제 -],
F.ADD_TRD_NUM AS [문서번호 - 호],
M.NAME, 
replace(replace(M.SUBJECT,CHAR(13),''),CHAR(10),''),
CONVERT(varchar(10),M.CREATE_DATE,121) AS 기안일, 
M.CREATOR,
M.CREATOR_DEPT, 
M.DELETE_DATE
FROM
EWF.[WF].[PROCESS_INSTANCE] AS M
LEFT JOIN [WF].[FORM_YEC587513360E4A069DE6F0966BB672D4] AS F
ON F.PROCESS_ID = M.OID
where FORM_ID = 'YEC587513360E4A069DE6F0966BB672D4' 
AND M.CREATE_DATE < '2016-01-01'
AND state = '7'
order by 기안일 


-- 결재 SAP 리스트 
[WF].[FORM_Y96CFB35A64CC4889BA9B50FEB49E5DB9] where creator = '김경호' AND SUGGESTDATE = '2017-02-06'

[WF].[WF_DOC_NUMBER]

SELECT
N.DOC_NAME,
M.NAME, 
replace(replace(M.SUBJECT,CHAR(13),''),CHAR(10),''),
CONVERT(varchar(10),M.CREATE_DATE,121) AS 기안일, 
M.CREATOR,
M.CREATOR_DEPT,
F.DB_KEYVALUE
FROM
[WF].[PROCESS_INSTANCE] AS M
LEFT JOIN [WF].[FORM_Y96CFB35A64CC4889BA9B50FEB49E5DB9] AS F  -- SAP KEYVALUE 를 가져오기 위한 JOIN
ON M.OID = F.PROCESS_ID
LEFT JOIN [WF].[WF_DOC_NUMBER] AS N
ON M.OID = N.PROCESS_ID
where M.FORM_ID = 'Y96CFB35A64CC4889BA9B50FEB49E5DB9' 
AND M.CREATE_DATE < '2016-01-01'
AND state = '7'
order by 기안일 



-- 구 전자결재 리스트
-- 구 전자결재 폼 리스트조회
select * from [eWFFORM_MIG].[dbo].[WF_FORMS] where form_name like '%거래처지원%'
select * from [eWFFORM_MIG].[dbo].[WF_FORMS] where form_name like '%거래%'
-- select top 100 * from EWF_MIG.[dbo].[PROCESS_INSTANCE]


SELECT
F.DOC_NUMBER,
M.NAME, 
replace(replace(M.SUBJECT,CHAR(13),''),CHAR(10),''),
CONVERT(varchar(10),M.CREATE_DATE,121) AS 기안일, 
M.CREATOR,
M.CREATOR_DEPT,
M.DELETE_DATE
FROM
EWF_MIG.[dbo].[PROCESS_INSTANCE] AS M
LEFT JOIN [eWFFORM_MIG].[dbo].[FORM_Y28B72F2F7EE54FB5BE13E8F2A3637978] AS F    --양식 결재 폼
ON M.OID = F.PROCESS_ID 
where M.NAME = '기안서'     -- 양식명
AND M.CREATE_DATE > '2012-01-01'  -- 특정 기간 이 후 
AND F.PROCESS_INSTANCE_STATE = '7'    -- 완료 플래그가 폼에 있음.
-- AND M.DELETE_DATE > '2017-02-07'   -- 삭제된 것은 제외
order by 기안일 



-- (구) 기안서 (지점용)
SELECT
F.DOC_NUMBER,
M.NAME, 
replace(replace(M.SUBJECT,CHAR(13),''),CHAR(10),''),
CONVERT(varchar(10),M.CREATE_DATE,121) AS 기안일, 
M.CREATOR,
M.CREATOR_DEPT
FROM
EWF_MIG.[dbo].[PROCESS_INSTANCE] AS M
LEFT JOIN [eWFFORM_MIG].[dbo].[FORM_YFA4BC440266849EB8DBA1A1FE7C55EE6] AS F   --양식 결재 폼
ON M.OID = F.PROCESS_ID 
where M.NAME = '기안서(지점용)'
AND M.CREATE_DATE > '2012-01-01'
AND F.PROCESS_INSTANCE_STATE = '7'    -- 완료 플래그가 폼에 있음.
order by 기안일 


-- (구) 거래선지원품의서
YB9222DABFA484AC6AC97F2A23C649789	10002	거래처지원품의서(판촉지원) 
Y2C8F33418C264039A69F9A4FA6EDA5B1	10046	거래처지원품의서(판촉)  
[eWFFORM_MIG].[dbo].[WF_DOC_NUMBER]
[eWFFORM].[dbo].[WF_DOC_NUMBER]
SELECT
F.DOC_NUMBER,
M.NAME, 
replace(replace(M.SUBJECT,CHAR(13),''),CHAR(10),''),
CONVERT(varchar(10),M.CREATE_DATE,121) AS 기안일, 
M.CREATOR,
M.CREATOR_DEPT,
F.OBJECTID
FROM
EWF_MIG.[dbo].[PROCESS_INSTANCE] AS M
LEFT JOIN [eWFFORM_MIG].[dbo].[FORM_YB9222DABFA484AC6AC97F2A23C649789] AS F   --양식 결재 폼
ON M.OID = F.PROCESS_ID 
where M.NAME = '거래처지원품의서(판촉지원)'
AND M.CREATE_DATE > '2012-01-01'
AND F.PROCESS_INSTANCE_STATE = '7'    -- 완료 플래그가 폼에 있음.
order by 기안일 



-- 주류 일반결재 리스트 (삭제되면 [WF].[PROCESS_INSTANCE_DELETE]로 이동)

SELECT
F.ADD_FST_NUM AS [문서번호 부서],
F.ADD_SCD_NUM AS [문서번호 제 -],
F.ADD_TRD_NUM AS [문서번호 - 호],
M.NAME, 
replace(replace(M.SUBJECT,CHAR(13),''),CHAR(10),''),
CONVERT(varchar(10),M.CREATE_DATE,121) AS 기안일, 
M.CREATOR,
M.CREATOR_DEPT
FROM
EWF.[WF].[PROCESS_INSTANCE] AS M
LEFT JOIN [WF].[FORM_Y3BEB1A495B79447BB7631074BC8BB189] AS F
ON M.OID = F.PROCESS_ID 
where FORM_ID = 'Y3BEB1A495B79447BB7631074BC8BB189' 
AND M.CREATE_DATE < '2016-01-01'
AND state = '7'
order by 기안일 

-- 주류(구) 일반결재 리스트 (삭제되면 [WF].[PROCESS_INSTANCE_DELETE]로 이동)

SELECT
N.DOC_NUMBER,
M.NAME, 
replace(replace(M.SUBJECT,CHAR(13),''),CHAR(10),''),
CONVERT(varchar(10),M.CREATE_DATE,121) AS 기안일, 
M.CREATOR,
M.CREATOR_DEPT
FROM
EWF.[WF].[PROCESS_INSTANCE] AS M
LEFT JOIN [WF].[FORM_Y6C89A0032FA444998260DBBCF683DAFC] AS F
ON M.OID = F.PROCESS_ID 
LEFT JOIN [EWF_LIQUOR].[WF].[WF_DOC_NUMBER] AS N
ON M.OID = N.PROCESS_ID
where M.FORM_ID = 'Y6C89A0032FA444998260DBBCF683DAFC' 
AND M.CREATE_DATE > '2012-01-01'
AND state = '7'
order by 기안일 






