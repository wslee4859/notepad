[참고]([Windows Server 공부방 :: PowerShell 로 원격 서버 관리하기. (tistory.com)](https://svrstudy.tistory.com/75))

**1. 원격 서버 설정하기.**

```
Enable-PSRemoting -Force
```

**2. 로컬 서버의 "신뢰할 수 있는 호스트 목록" 에 원격 서버 추가하기.**

```powershell
Set-Item WSMan:\localhost\Client\TrustedHosts -Value "원격서버IP 혹은 호스트네임"
```

```powershell
Set-Item WSMan:\localhost\Client\TrustedHosts -Value "원격서버1, 원격서버2"

# 기존 설정에 추가
$TrustedHostsOld = (Get-Item WSMan:\localhost\Client\TrustedHosts).Value
Set-Item WSMan:\localhost\Client\TrustedHosts -Value "$TrustedHostsOld, 원격서버IP 혹은 호스트네임"
```



**3. 원격 서버 접속용 자격증명(Credential) 만들기.**

**(방법1)**

```
$MyCredential = Get-Credential "아이디"
```



**(방법2)** 

**자동화가 필요할 때 사용할 수 있는 방법**

1. 패스워드를 변수로 입력받아서 확인하고 변수에 저장

   ```powershell
   $MyPassword = Read-Host "Password" -AsSecureString | ConvertFrom-SecureString

   # $MyPassword 찍어서 패스워드 확인
   $MyPassword = '01000000d08c9ddf0115d1118c7a00c04fc297eb010000007e2d44961ce420489f6b287fcca03d500000000002000000000003660000c000000010000000bfc8cbf6535253f5e841c1dd650fea240000000004800000a000000010000000f3565bfcb855acd68b63f3ead8323ea620000000ce1ceba7e9414e393fc162508a2ed4a373a934e75aefd7e70cb9c0fdab2fc7501400000003dee23658bc4041bdd4e1ffae777e185dcbff8a'
   $MyPassword = $MyPassword | ConvertTo-SecureString
   ```

   ![password](C:\Users\lotte\Documents\Git\Powershell\image\password.JPG)

2. ```powershell
   $MyPassword = $MyPassword | ConvertTo-SecureString
   $ObjectTypeName = "System.Management.Automation.PSCredential"
   $MyCredential = New-Object -TypeName $ObjectTypeName -ArgumentList "아이디",$MyPassword
   ```

**4. 원격 작업 하기**

